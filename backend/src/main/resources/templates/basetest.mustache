package {{packageName}};

import io.restassured.RestAssured;
import io.restassured.builder.RequestSpecBuilder;
import io.restassured.filter.log.RequestLoggingFilter;
import io.restassured.filter.log.ResponseLoggingFilter;
import io.restassured.http.ContentType;
import io.restassured.specification.RequestSpecification;
import org.testng.annotations.BeforeSuite;

/**
 * Base test class for the {{apiTitle}} ({{apiVersion}}) API test suite.
 *
 * <p>All generated test classes extend this class. It provides:
 * <ul>
 *   <li>A shared {@link RequestSpecification} pre-configured with the base URL,
 *       content type, and request/response logging</li>
 *   <li>A {@code @BeforeSuite} hook that runs once before all tests</li>
 * </ul>
 *
 * <p>To customise the configuration (e.g. add an auth header), modify the
 * {@link #setUp()} method below.
 *
 * <p>Generated by the Contract-Driven API Automation Engine.
 * API Base URL: {{baseUrl}}
 */
public class BaseTest {

    /**
     * Shared REST Assured request specification.
     *
     * <p>All test classes use this spec as a starting point. It is declared
     * {@code protected} so subclasses can read it directly without a getter.
     *
     * <p>Declaring it {@code static} means it is configured once per test suite
     * run (in {@link #setUp()}) and shared by all test instances — there is no
     * need to rebuild it for every test class or test method.
     */
    protected static RequestSpecification requestSpec;

    /**
     * Configures the shared REST Assured request specification before any tests run.
     *
     * <p>{@code @BeforeSuite} is a TestNG annotation — it runs this method exactly
     * once before the entire test suite starts. This is where you set up things
     * that are expensive to create and safe to reuse across all tests.
     *
     * <p><b>To add authentication:</b>
     * Add {@code .header("Authorization", "Bearer " + getToken())} to the builder.
     *
     * <p><b>To disable request/response logging in CI:</b>
     * Remove the two {@link RequestLoggingFilter} and {@link ResponseLoggingFilter} lines.
     */
    @BeforeSuite
    public void setUp() {
        requestSpec = new RequestSpecBuilder()
                // Base URI — all test requests will be sent to this host
                .setBaseUri("{{baseUrl}}")

                // All requests send and expect JSON by default
                .setContentType(ContentType.JSON)
                .setAccept(ContentType.JSON)

                // Log every request and response to the console for debugging.
                // These filters are especially useful during initial setup and CI diagnosis.
                .addFilter(new RequestLoggingFilter())
                .addFilter(new ResponseLoggingFilter())

                // Disable SSL certificate validation — useful for test/staging environments
                // that use self-signed certificates. Remove this for production environments.
                .setRelaxedHTTPSValidation()

                .build();

        // Set the global base URI as a convenience for tests that use RestAssured directly
        RestAssured.baseURI = "{{baseUrl}}";
    }
}
