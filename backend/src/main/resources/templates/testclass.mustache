package {{packageName}};

import {{basePackage}}.BaseTest;
import io.restassured.response.Response;
import org.testng.annotations.Test;
import org.testng.Assert;

import static io.restassured.RestAssured.given;

/**
 * REST Assured test class for the '{{resourceName}}' API resource.
 *
 * <p>API Base URL: {@code {{baseUrl}}}
 *
 * <p>This class contains one {@code @Test} method per endpoint defined in the
 * OpenAPI specification for the {@code /{{resourceName}}} resource group.
 * Each test method:
 * <ol>
 *   <li>Builds a request using the shared {@code requestSpec} from {@link BaseTest}</li>
 *   <li>Adds any required parameters or request body</li>
 *   <li>Executes the HTTP call</li>
 *   <li>Asserts the response status code</li>
 * </ol>
 *
 * <p><b>Before running:</b> Update the placeholder parameter values (marked with
 * TODO comments) with real test data for your environment.
 *
 * <p>Generated by the Contract-Driven API Automation Engine.
 */
public class {{className}} extends BaseTest {

    {{#methods}}
    // ─────────────────────────────────────────────────────────────────────────
    // TEST: {{httpMethod}} {{path}}
    // ─────────────────────────────────────────────────────────────────────────

    /**
     * Tests the {@code {{httpMethod}} {{path}}} endpoint.
     {{#summary}}
     * <p>{{summary}}
     {{/summary}}
     *
     * <p>Expected response: HTTP {{expectedStatus}}
     */
    @Test(description = "{{summary}}")
    public void {{methodName}}() {

        // ── Build the request ─────────────────────────────────────────────────
        // 'given()' is the REST Assured entry point.
        // We start from the shared requestSpec (configured in BaseTest.setUp())
        // which already has the base URL, content type, and logging set up.
        var request = given().spec(requestSpec);

        {{#hasPathParams}}
        // ── Path Parameters ───────────────────────────────────────────────────
        // These replace the {paramName} placeholders in the URL path.
        // TODO: Replace the placeholder values below with real test data.
        {{#pathParams}}
        request = request.pathParam("{{name}}", {{defaultValue}}); // TODO: set real {{name}} value
        {{/pathParams}}
        {{/hasPathParams}}

        {{#hasQueryParams}}
        // ── Query Parameters ──────────────────────────────────────────────────
        // These are appended to the URL as ?param=value&param2=value2.
        // TODO: Replace the placeholder values below with real test data.
        {{#queryParams}}
        request = request.queryParam("{{name}}", {{defaultValue}}); // TODO: set real {{name}} value
        {{/queryParams}}
        {{/hasQueryParams}}

        {{#hasBody}}
        // ── Request Body ──────────────────────────────────────────────────────
        // This endpoint expects a JSON request body.
        // TODO: Replace the placeholder below with a real request body object or JSON string.
        // Example: request = request.body(new YourRequestModel());
        // Example: request = request.body("{\"key\": \"value\"}");
        request = request.body("{}"); // TODO: replace with real request body
        {{/hasBody}}

        // ── Execute the request ───────────────────────────────────────────────
        // .when() transitions REST Assured from the "given" (setup) phase
        // to the "when" (action) phase. .{{httpMethod}}("{{path}}") sends the HTTP request.
        Response response = request
                .when()
                .{{httpMethod}}("{{path}}")
                .then()
                .extract()
                .response();

        // ── Assert the response ───────────────────────────────────────────────
        // Assert that the status code matches the expected value from the OpenAPI spec.
        // Add more assertions below as needed (e.g. response body field checks).
        Assert.assertEquals(
                response.getStatusCode(),
                {{expectedStatus}},
                "{{methodName}}: Expected HTTP {{expectedStatus}} but received " + response.getStatusCode()
        );

        // TODO: Add response body assertions here. Examples:
        // String body = response.getBody().asString();
        // Assert.assertTrue(body.contains("expectedValue"), "Response should contain expectedValue");
        //
        // Or deserialise to a POJO (if a model class was generated):
        // YourModel model = response.as(YourModel.class);
        // Assert.assertNotNull(model.getId(), "ID should not be null");
    }

    {{/methods}}
}
